<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Serverless Framework Components</title>
    <meta name="description" content="Gathering feedback on the redesign of the Serverless Framework CLI output." />
    <meta property="og:description" content="Gathering feedback on the redesign of the Serverless Framework CLI output." />
    <meta property="og:locale" content="en_US" />
    <meta property="og:image" content="https://sls-redesign.netlify.app/screen.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Serverless Framework CLI redesign" />
    <meta name="twitter:site" content="@goServerless">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon.png">
    <link href="styles.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100">

    <div id="app" class="container mx-auto max-w-2xl px-3 my-8">

        <h2>Deploy all</h2>

        <div class="terminal mx-auto mt-4 mb-8">
            <p>$ serverless deploy</p>
            <p>&nbsp;</p>
            <p>Deploying platform to stage dev</p>
            <p>&nbsp;</p>
            <p class="ml-5"><span class="text-red">✔</span>&nbsp; common &nbsp;<span class="text-gray">›</span> deployed <span class="text-gray">› 1s</span></p>
            <p class="ml-5">
                <span class="text-red">{{ frames[frame] }}</span>&nbsp; users &nbsp; <span class="text-gray">›</span>
                Updating CloudFormation stack <span class="text-gray">(1/5) </span>
                <span class="text-gray">› 12s</span>
            </p>
            <p class="ml-5">&nbsp;&nbsp; billing <span class="text-gray">› waiting</span></p>
            <p class="ml-5">&nbsp;&nbsp; reports <span class="text-gray">› waiting</span></p>
        </div>

        <div class="terminal mx-auto mt-4 mb-8">
            <p>$ serverless deploy</p>
            <p>&nbsp;</p>
            <p>Deploying platform to stage dev</p>
            <p>&nbsp;</p>
            <p class="ml-5"><span class="text-red">✔</span>&nbsp; common &nbsp;<span class="text-gray">›</span> deployed <span class="text-gray">› 1s</span></p>
            <p class="ml-5"><span class="text-red">✔</span>&nbsp; users &nbsp; <span class="text-gray">›</span> deployed <span class="text-gray">› 14s</span></p>
            <p class="ml-5"><span class="text-red">✔</span>&nbsp; billing <span class="text-gray">›</span> deployed <span class="text-gray">› 33s</span></p>
            <p class="ml-5">&nbsp;&nbsp; reports <span class="text-gray">› no changes › 1s</span></p>
            <p>&nbsp;</p>
            <p class="text-gray">common:</p>
            <p class="ml-5"><span class="text-gray">table:</span> platform-dev-table</p>
            <p class="text-gray">billing:</p>
            <p class="ml-5"><span class="text-gray">endpoints:</span> https://3fr81y9fpa.execute-api.us-east-1.amazonaws.com/</p>
            <p class="ml-5 text-gray">functions:</p>
            <p class="ml-10"><span class="text-gray">index:</span> myapp-dev-index</p>
            <p class="text-gray">users:</p>
            <p class="ml-5"><span class="text-gray">endpoints:</span> https://cj051y1flg.execute-api.us-east-1.amazonaws.com/</p>
            <p class="ml-5 text-gray">functions:</p>
            <p class="ml-10"><span class="text-gray">index:</span> myapp-dev-index</p>
        </div>

        <h2>Errors</h2>

        <p>Initialization error:</p>
        <div class="terminal mx-auto mt-4 mb-8">
            <p>$ serverless deploy</p>
            <p class="text-gray">Environment: darwin, node 17.4.0, compose 0.0.8</p>
            <p class="text-gray">Docs: &nbsp; &nbsp; &nbsp;&nbsp; github.com/serverless/compose</p>
            <p class="text-gray">Bugs: &nbsp; &nbsp; &nbsp;&nbsp; github.com/serverless/compose/issues</p>
            <p>&nbsp;</p>
            <p class="text-red">Error:</p>
            <p>Configuration error at 'app': should be a string</p>
            <p>&nbsp;</p>
            <p class="text-gray">Verbose logs are available in ".serverless/compose.log"</p>
        </div>

        <p>Initialization programmer error:</p>
        <div class="terminal mx-auto mt-4 mb-8">
            <p>$ serverless deploy</p>
            <p class="text-gray">Environment: darwin, node 17.4.0, compose 0.0.8</p>
            <p class="text-gray">Docs: &nbsp; &nbsp; &nbsp;&nbsp; github.com/serverless/compose</p>
            <p class="text-gray">Bugs: &nbsp; &nbsp; &nbsp;&nbsp; github.com/serverless/compose/issues</p>
            <p>&nbsp;</p>
            <p class="text-red">Error:</p>
            <p>TypeError: Cannot read properties of undefined (reading 'logger')</p>
            <p>&nbsp; at start (compose/src/ComponentsService.js:423:34)</p>
            <p>&nbsp; at boot (compose/src/index.js:23:34)</p>
            <p>&nbsp;</p>
            <p class="text-gray">Verbose logs are available in ".serverless/compose.log"</p>
        </div>

        <p>In-progress error:</p>
        <div class="terminal mx-auto mt-4 mb-8">
            <p>$ serverless deploy</p>
            <p>&nbsp;</p>
            <p>Deploying platform to stage dev</p>
            <p>&nbsp;</p>
            <p class="ml-5"><span class="text-red">✔</span>&nbsp; common <span class="text-gray">›</span> deployed <span class="text-gray">› 1s</span></p>
            <p class="ml-5 text-red"><span class="text-red">✖</span>&nbsp; users &nbsp;<span class="text-gray">›</span> error <span class="text-gray">› 13s</span></p>
            <p>&nbsp;</p>
            <p>Invalid region "eu-east-4"</p>
            <p>&nbsp;</p>
            <p class="ml-5">&nbsp;&nbsp; billing <span class="text-gray">› skipped</span></p>
            <p>&nbsp;</p>
            <p class="text-gray">Verbose logs are available in ".serverless/compose.log"</p>
        </div>

        <p>In-progress CloudFormation error:</p>
        <div class="terminal mx-auto mt-4 mb-8">
            <p>$ serverless deploy</p>
            <p>&nbsp;</p>
            <p>Deploying platform to stage dev</p>
            <p>&nbsp;</p>
            <p class="ml-5"><span class="text-red">✔</span>&nbsp; common <span class="text-gray">›</span> deployed <span class="text-gray">› 1s</span></p>
            <p class="ml-5 text-red"><span class="text-red">✖</span>&nbsp; users &nbsp;<span class="text-gray">›</span> error <span class="text-gray">› 13s</span></p>
            <p>&nbsp;</p>
            <p>UPDATE_FAILED: HelloLambdaFunction <span class="text-gray">(AWS::Lambda::Function)</span></p>
            <p>Resource handler returned message: "Value nodejs12.xa at 'runtime' failed to satisfy constraint: Member must satisfy enum value set: [java8, java11, nodejs10.x, nodejs12.x, python2.7, python3.6, python3.7, python3.8, dotnetcore2.1, go1.x, ruby2.5] or be a valid ARN.</p>
            <p>&nbsp;</p>
            <p class="text-gray">View the full error: https://us-east-1.console.aws.amazon.com/cloudformation/home?region=us-east-1#/stack/detail?stackId=arn%3Aaws%3Acloudformation%3Aus-east-1%3A416566615250%3Astack%2Fmyapp-dev%2F8f271030-bbec-11eb-b27c-0a4ced5e22b5</p>
            <p>&nbsp;</p>
            <p class="ml-5">&nbsp;&nbsp; billing <span class="text-gray">› skipped</span></p>
            <p>&nbsp;</p>
            <p class="text-gray">Verbose logs are available in ".serverless/compose.log"</p>
        </div>

        <p>In-progress programmer error. We cannot display the stack trace because it would be too verbose. Instead the detailed error is logged to the verbose output.</p>
        <div class="terminal mx-auto mt-4 mb-8">
            <p>$ serverless deploy</p>
            <p>&nbsp;</p>
            <p>Deploying platform to stage dev</p>
            <p>&nbsp;</p>
            <p class="ml-5"><span class="text-red">✔</span>&nbsp; common <span class="text-gray">›</span> deployed <span class="text-gray">› 1s</span></p>
            <p class="ml-5 text-red"><span class="text-red">✖</span>&nbsp; users &nbsp;<span class="text-gray">›</span> error <span class="text-gray">› 13s</span></p>
            <p>&nbsp;</p>
            <p>TypeError: Cannot read properties of undefined (reading 'logger')</p>
            <p>&nbsp;</p>
            <p class="ml-5">&nbsp;&nbsp; billing <span class="text-gray">› skipped</span></p>
            <p>&nbsp;</p>
            <p class="text-gray">Verbose logs are available in ".serverless/compose.log"</p>
        </div>

        <p>Error not-in-progress:</p>
        <div class="terminal mx-auto mt-4 mb-8">
            <p>$ serverless info</p>
            <p><span class="text-gray">users › START</span></p>
            <p><span class="text-gray">billing › START</span></p>
            <p><span class="text-gray">users › 2021-11-16 12:24:34.271</span> INFO Users created</p>
            <p><span class="text-gray">users › END Duration: 2.56 ms (init: 178.34 ms)	Memory used: 64 MB</span></p>
            <p><span class="text-gray">common › </span><span class="text-red">Error:</span> Invalid region "eu-east-4"</p>
            <p><span class="text-gray">billing › 2021-11-16 12:24:34.271</span> INFO Invoice sent</p>
            <p><span class="text-gray">billing › END Duration: 5.58 ms	Memory used: 64 MB</span></p>
            <p>&nbsp;</p>
            <p class="text-gray">Verbose logs are available in ".serverless/compose.log"</p>
            <p>&nbsp;</p>
            <p>$ serverless info <span class="text-gray"># multiline error message</span></p>
            <p><span class="text-gray">users › START</span></p>
            <p><span class="text-gray">billing › START</span></p>
            <p><span class="text-gray">users › 2021-11-16 12:24:34.271</span> INFO Users created</p>
            <p><span class="text-gray">users › END Duration: 2.56 ms (init: 178.34 ms)	Memory used: 64 MB</span></p>
            <p><span class="text-gray">common › </span><span class="text-red">Error:</span> Invalid region "eu-east-4"</p>
            <p><span class="text-gray">common ›</span></p>
            <p><span class="text-gray">common › </span>Did you mean "eu-east-1"?</p>
            <p><span class="text-gray">billing › 2021-11-16 12:24:34.271</span> INFO Invoice sent</p>
            <p><span class="text-gray">billing › END Duration: 5.58 ms	Memory used: 64 MB</span></p>
            <p>&nbsp;</p>
            <p class="text-gray">Verbose logs are available in ".serverless/compose.log"</p>
        </div>

        <h2>Component-specific command</h2>

        <div class="terminal mx-auto mt-4 mb-8">
            <p>$ serverless billing:deploy</p>
            <p>&nbsp;</p>
            <p>Deploying billing to stage dev</p>
            <p>&nbsp;</p>
            <p class="ml-5"><span class="text-red">✔</span>&nbsp; billing <span class="text-gray">›</span> deployed <span class="text-gray">› 33s</span></p>
            <p>&nbsp;</p>
            <p class="text-gray">billing:</p>
            <p class="ml-5"><span class="text-gray">endpoints:</span> https://3fr81y9fpa.execute-api.us-east-1.amazonaws.com/</p>
            <p class="ml-5 text-gray">functions:</p>
            <p class="ml-10"><span class="text-gray">index:</span> myapp-dev-index</p>
        </div>

        <h2>Logs</h2>

        <div class="terminal mx-auto mt-4 mb-8">
            <p>$ serverless logs --tail</p>
            <p><span class="text-gray">users &nbsp; › START</span></p>
            <p><span class="text-gray">billing › START</span></p>
            <p><span class="text-gray">users &nbsp; › 2021-11-16 12:24:34.271</span> INFO Users created</p>
            <p><span class="text-gray">users &nbsp; › END Duration: 2.56 ms (init: 178.34 ms)	Memory used: 64 MB</span></p>
            <p><span class="text-gray">billing › 2021-11-16 12:24:34.271</span> INFO Invoice sent</p>
            <p><span class="text-gray">billing › END Duration: 5.58 ms	Memory used: 64 MB</span></p>
            <p>&nbsp;</p>
            <p class="ml-5"><span class="text-red">{{ frames[frame] }}</span>&nbsp; users &nbsp; <span class="text-gray">›</span> logs</p>
            <p class="ml-5"><span class="text-red">{{ frames[frame] }}</span>&nbsp; billing <span class="text-gray">›</span> logs</p>
        </div>

        <div class="terminal mx-auto mt-4 mb-8">
            <p>$ serverless users:logs</p>
            <p><span class="text-gray">START</span></p>
            <p><span class="text-gray">2021-11-16 12:24:34.271</span> INFO Users created</p>
            <p><span class="text-gray">END Duration: 2.56 ms (init: 178.34 ms)	Memory used: 64 MB</span></p>
        </div>

        <h2>Verbose</h2>

        <div class="terminal mx-auto mt-4 mb-8">
            <p>$ serverless deploy --verbose</p>
            <p>&nbsp;</p>
            <p>Deploying platform to stage dev</p>
            <p>&nbsp;</p>
            <p><span class="text-gray">common &nbsp;›</span> Deploying platform-common to stage dev (us-east-1)</p>
            <p><span class="text-gray">common &nbsp;›</span> Packaging</p>
            <p><span class="text-gray">common &nbsp;›</span> Uploading (50 KB)</p>
            <p><span class="text-gray">common &nbsp;›</span> Service deployed to stack platform-common-dev</p>
            <p><span class="text-gray">users &nbsp; ›</span> Deploying platform-users to stage dev (us-east-1)</p>
            <p><span class="text-gray">billing ›</span> Deploying platform-billing to stage dev (us-east-1)</p>
            <p><span class="text-gray">users &nbsp; ›</span> Packaging</p>
            <p><span class="text-gray">users &nbsp; ›</span> Uploading (222 KB)</p>
            <p><span class="text-gray">billing ›</span> Packaging</p>
            <p>&nbsp;</p>
            <p class="ml-5"><span class="text-red">✔</span>&nbsp; common &nbsp;<span class="text-gray">›</span> deployed <span class="text-gray">› 1s</span></p>
            <p class="ml-5">
                <span class="text-red">{{ frames[frame] }}</span>&nbsp; users &nbsp; <span class="text-gray">›</span>
                Uploading (222 KB)
                <span class="text-gray">› 12s</span>
            </p>
            <p class="ml-5">
                <span class="text-red">{{ frames[frame] }}</span>&nbsp; billing <span class="text-gray">›</span>
                Packaging
                <span class="text-gray">› 12s</span>
            </p>
            <p class="ml-5">&nbsp;&nbsp; reports <span class="text-gray">› waiting</span></p>
        </div>

        <hr class="border-gray-400 my-32">

        <h2>Former alternative approaches</h2>
        <div>
            <h3>A</h3>
            <div class="terminal mx-auto mt-4 mb-8">
                <p>$ serverless deploy</p>
                <p>&nbsp;</p>
                <p class="ml-5"><span class="text-gray">1s ›</span> common <span class="text-gray">›</span> deployed</p>
                <p>&nbsp;</p>
                <p><span class="text-red">{{ frames[frame] }}</span> &nbsp; Deploying platform to stage dev</p>
                <p>&nbsp;</p>
                <p class="ml-5"><span class="text-red">{{ frames[frame] }}</span> &nbsp; users <span class="text-gray">›</span> deploying</p>
                <p class="ml-5"><span class="text-gray">…</span> &nbsp; billing <span class="text-gray">›</span> waiting</p>
            </div>
            <div class="terminal mx-auto mt-4 mb-8">
                <p>$ serverless deploy</p>
                <p>&nbsp;</p>
                <p class="ml-5"><span class="text-gray">1s ›</span> common <span class="text-gray">›</span> deployed</p>
                <p class="ml-5"><span class="text-gray">12s ›</span> users <span class="text-gray">›</span> deployed</p>
                <p class="ml-5"><span class="text-gray">33s ›</span> billing <span class="text-gray">›</span> deployed</p>
                <p>&nbsp;</p>
                <p><span class="text-red">✔</span> Application platform deployed to stage dev <span class="text-gray">(45s)</span></p>
                <p>&nbsp;</p>
                <p class="text-gray">common:</p>
                <p class="ml-5"><span class="text-gray">table:</span> platform-dev-table</p>
                <p class="text-gray">billing:</p>
                <p class="ml-5"><span class="text-gray">endpoints:</span> https://3fr81y9fpa.execute-api.us-east-1.amazonaws.com/</p>
                <p class="ml-5 text-gray">functions:</p>
                <p class="ml-10"><span class="text-gray">index:</span> myapp-dev-index</p>
                <p class="text-gray">users:</p>
                <p class="ml-5"><span class="text-gray">endpoints:</span> https://cj051y1flg.execute-api.us-east-1.amazonaws.com/</p>
                <p class="ml-5 text-gray">functions:</p>
                <p class="ml-10"><span class="text-gray">index:</span> myapp-dev-index</p>
            </div>

            <h3>B</h3>
            <div class="terminal mx-auto mt-4 mb-8">
                <p>$ serverless deploy</p>
                <p>&nbsp;</p>
                <p>Deploying platform to stage dev</p>
                <p>&nbsp;</p>
                <p><span class="text-gray">1s ›</span> common &nbsp;<span class="text-gray">›</span> deployed</p>
                <p><span class="text-red">{{ frames[frame] }}</span> &nbsp;<span class="text-gray">›</span> users &nbsp; <span class="text-gray">›</span> deploying</p>
                <p>&nbsp; &nbsp;<span class="text-gray">›</span> billing <span class="text-gray">› waiting</span></p>
            </div>
            <div class="terminal mx-auto mt-4 mb-8">
                <p>$ serverless deploy</p>
                <p>&nbsp;</p>
                <p>Deploying platform to stage dev</p>
                <p>&nbsp;</p>
                <p><span class="text-gray">1s &nbsp;›</span> common &nbsp;<span class="text-gray">›</span> deployed</p>
                <p><span class="text-gray">12s ›</span> users &nbsp; <span class="text-gray">›</span> deployed</p>
                <p><span class="text-gray">33s ›</span> billing <span class="text-gray">›</span> deployed</p>
                <p>&nbsp;</p>
                <p class="text-gray">common:</p>
                <p class="ml-5"><span class="text-gray">table:</span> platform-dev-table</p>
                <p class="text-gray">billing:</p>
                <p class="ml-5"><span class="text-gray">endpoints:</span> https://3fr81y9fpa.execute-api.us-east-1.amazonaws.com/</p>
                <p class="ml-5 text-gray">functions:</p>
                <p class="ml-10"><span class="text-gray">index:</span> myapp-dev-index</p>
                <p class="text-gray">users:</p>
                <p class="ml-5"><span class="text-gray">endpoints:</span> https://cj051y1flg.execute-api.us-east-1.amazonaws.com/</p>
                <p class="ml-5 text-gray">functions:</p>
                <p class="ml-10"><span class="text-gray">index:</span> myapp-dev-index</p>
            </div>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@3"></script>
    <script src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js"></script>
    <script>
        // Add anchors to headers
        anchors.add();

        const fetchPromise = fetch('https://3a3ygeli99.execute-api.us-east-1.amazonaws.com/discussions').then(data => data.json());

        const app = Vue.createApp({
            data: () => ({
                step: 0,
                second: 0,
                frames: ['⠋', '⠙', '⠹', '⠸', '⠼', '⠴', '⠦', '⠧', '⠇', '⠏'],
                frame: 0,
            }),
            async mounted() {
                setInterval(() => {
                    this.step = (this.step + 1) % 6;
                }, 3000);
                setInterval(() => {
                    this.second = (this.second + 1) % 18;
                }, 1000);
                setInterval(() => {
                    this.frame = (this.frame + 1) % this.frames.length;
                }, 100);
            },
        });

        app.component('comments', {
            props: ['id'],
            data: () => ({
                url: 'https://github.com/serverless/cli-design/discussions',
                commentCount: 0,
            }),
            template: `
                <div class="my-4 text-center text-red underline" title="Post feedback on the new design in GitHub discussions">
                <a :href="url" class="px-6 py-3 hover:underline">
                    <svg class="h-6 w-6 inline mr-2" aria-hidden="true" viewBox="0 0 24 24" version="1.1" fill="currentColor"><path d="M1.75 1A1.75 1.75 0 000 2.75v9.5C0 13.216.784 14 1.75 14H3v1.543a1.457 1.457 0 002.487 1.03L8.061 14h6.189A1.75 1.75 0 0016 12.25v-9.5A1.75 1.75 0 0014.25 1H1.75zM1.5 2.75a.25.25 0 01.25-.25h12.5a.25.25 0 01.25.25v9.5a.25.25 0 01-.25.25h-6.5a.75.75 0 00-.53.22L4.5 15.44v-2.19a.75.75 0 00-.75-.75h-2a.25.25 0 01-.25-.25v-9.5z"></path><path d="M22.5 8.75a.25.25 0 00-.25-.25h-3.5a.75.75 0 010-1.5h3.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0122.25 20H21v1.543a1.457 1.457 0 01-2.487 1.03L15.939 20H10.75A1.75 1.75 0 019 18.25v-1.465a.75.75 0 011.5 0v1.465c0 .138.112.25.25.25h5.5a.75.75 0 01.53.22l2.72 2.72v-2.19a.75.75 0 01.75-.75h2a.25.25 0 00.25-.25v-9.5z"></path></svg>
                    <span v-if="commentCount <= 0">Provide feedback in GitHub</span>
                    <span v-if="commentCount == 1">{{ commentCount }} comment in GitHub</span>
                    <span v-if="commentCount > 1">{{ commentCount }} comments in GitHub</span></a>
                </div>`,
            mounted() {
                this.url = `https://github.com/serverless/cli-design/discussions/${this.id}`;
                fetchPromise.then((data) => {
                    this.commentCount = (this.id in data) ? data[this.id].commentCount : 0;
                });
            },
        })

        app.mount('#app');
    </script>

</body>
</html>
